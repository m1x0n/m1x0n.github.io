var O=Object.defineProperty;var P=e=>{throw TypeError(e)};var x=(e,t,r)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var n=(e,t,r)=>x(e,typeof t!="symbol"?t+"":t,r),C=(e,t,r)=>t.has(e)||P("Cannot "+r);var a=(e,t,r)=>(C(e,t,"read from private field"),r?r.call(e):t.get(e)),c=(e,t,r)=>t.has(e)?P("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),l=(e,t,r,i)=>(C(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r);import{createApp as I}from"https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();const k="/assets/placeholder-CF2jD5er.webm";var p;class y{constructor(t){c(this,p);l(this,p,t)}content(){return a(this,p)}}p=new WeakMap;var f,u;class h{constructor(t=null,r=null){c(this,f);c(this,u);l(this,f,t),l(this,u,r)}static fromCat(t){return new this(t,null)}static fromError(t){return new this(null,t)}isOk(){return!a(this,u)}isError(){return!this.isOk()}cat(){return a(this,f)}error(){return a(this,u)}}f=new WeakMap,u=new WeakMap;class w{constructor(t="",r={}){this.endpoint=t,this.options=r}async getCatOrError(){return Promise.resolve(h.fromError(new Error("Must be implemented")))}}class L extends w{constructor(){super("https://cataas.com/cat/gif?json=true",{}),this.name="cataas"}async getCatOrError(){return fetch(this.endpoint,{mode:"no-cors"}).then(t=>t.json()).then(t=>Promise.resolve(h.fromCat(new y("https://cataas.com/cat/"+t.id)))).catch(t=>Promise.resolve(h.fromError("["+this.name+"] "+t.toString())))}}class j extends w{constructor(){super("https://api.thecatapi.com/v1/images/search?limit=1&mime_types=gif",{key:"DEMO-API-KEY"}),this.name="thecatapi"}async getCatOrError(){return fetch(this.endpoint,{headers:{"x-api-key":this.options.key}}).then(t=>t.json()).then(t=>Promise.resolve(h.fromCat(new y(t[0].url)))).catch(t=>Promise.resolve(h.fromError("["+this.name+"] "+t.toString())))}}class A extends w{constructor(){super("https://api.giphy.com/v1/gifs/random?tag=cat&rating=g",{key:"atSc6rXC6mkBvhxFJN5TT04lH6Y3uixi"}),this.name="giphy"}async getCatOrError(){return fetch(this.endpoint+`&api_key=${this.options.key}`).then(t=>t.json()).then(t=>Promise.resolve(h.fromCat(new y(t.data.images.downsized.url)))).catch(t=>Promise.resolve(h.fromError("["+this.name+"] "+t.toString())))}}var g;class F{constructor(t){c(this,g);l(this,g,t)}cat(){return new y(a(this,g))}}g=new WeakMap;var v,m;class S{constructor(t,r){c(this,v);c(this,m);l(this,v,t),l(this,m,r)}async tryGet(t,r,i){let s=a(this,v)[t];console.log("Attempt: %d of %d. Trying %s provider",r,i,s.name);let o=await s.getCatOrError();if(o.isError()){if(console.log(o.error().toString()),r+1>i)return Promise.resolve(a(this,m).cat());let d=function(E){return{0:1,1:2,2:0}[E]}(t);return this.tryGet(d,r+1,i)}return Promise.resolve(o.cat())}async getCat(){let r=1,i=Date.now()%3;return this.tryGet(i,r,3)}getFallbackCat(){return a(this,m).cat()}}v=new WeakMap,m=new WeakMap;const b=new S([new j,new L,new A],new F(k));class B{constructor(t=5,r="🐾",i=500,s="Load more 🐾"){n(this,"timer");n(this,"bar");n(this,"value");n(this,"max");n(this,"delay");n(this,"defaultValue");this.timer=null,this.value=[],this.bar=r,this.max=t,this.delay=i,this.defaultValue=s}start(){this.value=[this.bar],this.timer=setInterval(()=>this.advance(),this.delay)}end(){clearInterval(this.timer),this.timer=null}advance(){if(this.value.length===this.max){this.value=[this.bar];return}this.value.length>0&&this.value.length<this.max&&this.value.push(this.bar)}val(){return this.timer?this.value.join(""):this.defaultValue}}const D="https://github.com/m1x0n";function G(e){return{$template:"#cats-viewer",loading:!1,catImage:{src:b.getFallbackCat().content(),onLoad:null,isFallback:function(){return this.src.includes("placeholder")}},progressBar:new B,async loadImage(){this.loading=!0,this.progressBar.start(),this.catImage.onLoad=null;let t=await b.getCat();this.catImage.src=t.content(),this.catImage.onLoad=()=>{this.loading=!1,this.progressBar.end()}},viewProjects(){window.location.href=D},viewWasmZero(){window.location.href="/wasmzero/index.html"},label(){return this.progressBar.val()}}}I({CatsViewer:G}).mount();
